<!DOCTYPE html>
<html>
<head>
  <title>MQTT Web Client</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js"></script>
</head>
<body>
  <h2>MQTT Web Client</h2>
  <label>Client ID:</label>
  <input id="clientId" value="webclient123"><br>
  <label>Topic:</label>
  <input id="topic" value="test/topic"><br>
  <label>Message:</label>
  <input id="msg" value="Hello from browser"><br>
  <button onclick="send()">Send</button>
  <pre id="log"></pre>

  <script>
    let client;
    let log = document.getElementById("log");

    function logMessage(msg) {
      log.textContent += msg + "\n";
    }

    window.onload = function () {
      const cid = document.getElementById("clientId").value;
      client = new Paho.MQTT.Client("broker.hivemq.com", 8000, cid);

      client.onConnectionLost = function (res) {
        logMessage("Disconnected: " + res.errorMessage);
      };

      client.onMessageArrived = function (message) {
        logMessage("[RECV] " + message.destinationName + ": " + message.payloadString);
      };

      client.connect({
        useSSL: false,
        onSuccess: () => {
          logMessage("[Connected to HiveMQ broker]");
          client.subscribe("test4472/#");
          logMessage("[Subscribed to test/#]");
        },
        onFailure: e => logMessage("Connect failed: " + e.errorMessage)
      });
    };

    function send() {
      const topic = document.getElementById("topic").value;
      const text = document.getElementById("msg").value;
      const message = new Paho.MQTT.Message(text);
      message.destinationName = topic;
      client.send(message);
      logMessage("[Sent] " + text);
    }
  </script>
</body>
</html>


